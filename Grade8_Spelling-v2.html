<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Knights of Columbus – 2026 Knowledge Contest – Spelling Grade 8 (Auto-Scored)</title>
  <style>
    :root{
      --bg:#f6f7fb; --card:#ffffff; --ink:#1f2937; --muted:#6b7280;
      --kc-red:#b5121b; --kc-blue:#003a70;
      --ok:#e7f8ef; --bad:#fde8e8; --border:#e5e7eb;
      --shadow:0 8px 24px rgba(0,0,0,.08); --radius:14px;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Noto Sans","Apple Color Emoji","Segoe UI Emoji";background:var(--bg);color:var(--ink);line-height:1.35;}
    .wrap{max-width:980px;margin:24px auto;padding:0 14px}
    header{background:linear-gradient(135deg,var(--kc-blue),#0b5aa1);color:white;border-radius:var(--radius);box-shadow:var(--shadow);padding:18px 18px 16px;}
    .title{display:flex;flex-wrap:wrap;gap:10px;align-items:baseline;justify-content:space-between}
    h1{margin:0;font-size:20px;letter-spacing:.2px}
    .badge{background:rgba(255,255,255,.16);border:1px solid rgba(255,255,255,.22);padding:6px 10px;border-radius:999px;font-size:12px}
    .sub{margin:8px 0 0;font-size:13px;color:rgba(255,255,255,.92)}
    .card{background:var(--card);margin:14px 0;border:1px solid var(--border);border-radius:var(--radius);box-shadow:0 6px 18px rgba(0,0,0,.06);padding:16px;}
    .instructions{display:grid;gap:8px;font-size:14px;}
    .instructions ul{margin:6px 0 0 18px}
    .row{display:flex;flex-wrap:wrap;gap:12px;align-items:center;margin-top:12px}
    label{font-weight:600}
    input[type="text"]{width:min(460px,100%);padding:10px 12px;border:1px solid var(--border);border-radius:10px;font-size:14px;outline:none;}
    input[type="text"]:focus{border-color:#93c5fd;box-shadow:0 0 0 3px rgba(147,197,253,.35)}
    .section-title{margin:0 0 10px;font-size:16px;color:var(--kc-blue);display:flex;align-items:center;gap:10px}
    .section-title .pill{font-size:12px;background:#eef2ff;border:1px solid #dbeafe;padding:4px 10px;border-radius:999px;color:#1e40af}
    .q{border:1px solid var(--border);border-radius:12px;padding:12px;margin:10px 0;background:#fff;}
    .q.correct{background:var(--ok); border-color:#a7f3d0}
    .q.incorrect{background:var(--bad); border-color:#fecaca}
    .qhead{display:flex;gap:10px;align-items:flex-start}
    .qnum{min-width:34px;height:34px;border-radius:10px;display:grid;place-items:center;background:#f3f4f6;border:1px solid var(--border);font-weight:700;}
    .qtext{flex:1}
    .sa{margin-top:10px;display:flex;flex-wrap:wrap;gap:10px;align-items:center}
    .sa input[type="text"]{width:min(360px,100%)}
    .hint{font-size:12px;color:var(--muted);margin-top:6px}
    .actions{display:flex;flex-wrap:wrap;gap:10px;align-items:center}
    button{border:0;border-radius:12px;padding:10px 14px;font-weight:700;cursor:pointer;font-size:14px;}
    .primary{background:var(--kc-red);color:white}
    .primary:hover{filter:brightness(.95)}
    .ghost{background:#f3f4f6;color:#111827;border:1px solid var(--border)}
    .ghost:hover{background:#eef2f7}
    .note{color:var(--muted);font-size:12px}
    .results{border:1px solid var(--border);border-radius:14px;padding:14px;background:#f8fafc;display:none;}
    .results h2{margin:0 0 8px;font-size:16px}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:10px;margin-top:10px}
    .stat{background:white;border:1px solid var(--border);border-radius:12px;padding:10px;}
    .stat .k{font-size:12px;color:var(--muted)}
    .stat .v{font-size:18px;font-weight:800;margin-top:2px}
    .answer-key{margin-top:10px;display:none;font-size:13px;color:#111827;}
    .answer-key .tag{display:inline-block;padding:4px 10px;border-radius:999px;border:1px solid var(--border);background:#ffffff;font-weight:700;margin-right:8px;}
    .answer-key .val{color:#111827;font-weight:800;}
    .answer-key .muted{color:var(--muted);font-weight:600;}
    @media print{
      body{background:white}
      header{box-shadow:none}
      .card{box-shadow:none}
      button,.note{display:none!important}
      .results{display:block!important}
      .answer-key{display:none!important}
    }
  </style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="title">
      <h1>Knights of Columbus – 2026 Knowledge Contest – Spelling (Grade 8)</h1>
      <div class="badge">Online • Auto-Scored • Printable</div>
    </div>
    <div class="sub">50 questions • 1 point each • Type the corrected misspelled word, or type <strong>none</strong> if all four words are correct.</div>
  </header>

  <div class="card">
    <div class="instructions">
      <div><strong>Instructions</strong></div>
      <ul>
        <li><strong>Time:</strong> 30 minutes. Answer as many of the 50 questions as you can.</li>
        <li><strong>Format:</strong> Each group of words either has one misspelling or all four words are correct.</li>
        <li><strong>Answer:</strong> Type the corrected word. Type <strong>none</strong> if there are no errors in a group.</li>
        <li><strong>Submit:</strong> Click <strong>Submit &amp; Score</strong> to score instantly and download a CSV of answers.</li>
      </ul>
      <div class="row">
        <label for="studentName">Student Name <span style="color:#b5121b">*</span>:</label>
        <input id="studentName" type="text" placeholder="Type your name here…" autocomplete="name" />
      </div>
      <div class="note">Teacher features (Reset / Reveal Answers) require the teacher code. Submit is allowed one time only (with confirmation).</div>
    </div>
  </div>

  <form id="testForm" class="card" onsubmit="return false;">
    <div class="section-title">Spelling <span class="pill">Questions 1–50</span></div>
    <div id="qs"></div>

    <div class="actions" style="margin-top:16px;">
      <button class="primary" id="scoreBtn" type="button">Submit &amp; Score</button>
      <button class="ghost" id="resetBtn" type="button">Reset (Teacher)</button>
      <button class="ghost" id="revealBtn" type="button">Reveal Answers (Teacher)</button>
      <span class="note">Only answered questions are highlighted ✅/❌ after scoring.</span>
    </div>

    <div class="results" id="resultsBox" aria-live="polite">
      <h2 id="resultsTitle">Results</h2>
      <div class="grid">
        <div class="stat"><div class="k">Student</div><div class="v" id="rName">—</div></div>
        <div class="stat"><div class="k">Total Score</div><div class="v" id="rTotal">—</div></div>
        <div class="stat"><div class="k">Percent</div><div class="v" id="rPct">—</div></div>
        <div class="stat"><div class="k">Answered</div><div class="v" id="rAns">—</div></div>
      </div>
      <div class="note" style="margin-top:10px;">Printing tip: Use your browser’s Print command. This page is print-friendly.</div>
    </div>
  </form>
</div>

<script>
const TEACHER_CODE = "KOC2026";
const QUESTIONS = [
  {n:1, t:"poinsetta boredom priority circulate", a:"poinsettia"},
  {n:2, t:"curteous verdict cinema pursue", a:"courteous"},
  {n:3, t:"brochure disease outwit acheive", a:"achieve"},
  {n:4, t:"perjury conceive vengence auxiliary", a:"vengeance"},
  {n:5, t:"journalist misery chaperone substantail", a:"substantial"},
  {n:6, t:"outrageous portrait transet miscellaneous", a:"transit"},
  {n:7, t:"applause concise fracture luncheon", a:"none"},
  {n:8, t:"zenith embarass astonish subtle", a:"embarrass"},
  {n:9, t:"mountainous earlier poisionus structure", a:"poisonous"},
  {n:10, t:"appreciation devour rehearsel artificial", a:"rehearsal"},
  {n:11, t:"hazardous fortunate cemetary spacious", a:"cemetery"},
  {n:12, t:"yacht panicked sledge wretched", a:"none"},
  {n:13, t:"buoyant xylophone circiut crimson", a:"circuit"},
  {n:14, t:"wisdom witness accountent razor", a:"accountant"},
  {n:15, t:"discipline mustash immense agricultural", a:"mustache"},
  {n:16, t:"immigrant salmon emmigrate indigent", a:"emigrate"},
  {n:17, t:"refer anziety release sheriff", a:"anxiety"},
  {n:18, t:"conform invoice flourescent limousine", a:"fluorescent"},
  {n:19, t:"compact presume pamphlit campaign", a:"pamphlit"},
  {n:20, t:"society adjoin corpuscle counterfiet", a:"counterfeit"},
  {n:21, t:"compulsory conspiracy persistance inflection", a:"persistence"},
  {n:22, t:"conjuncion oppressive speculate respiration", a:"conjunction"},
  {n:23, t:"astronomy solemm chalice alleviate", a:"solemn"},
  {n:24, t:"decieve paramedic coordination submerge", a:"deceive"},
  {n:25, t:"rhinoceros narled rhapsody invalid", a:"gnarled"},
  {n:26, t:"malnutrition inevitable accummulate acknowledge", a:"accumulate"},
  {n:27, t:"guilt converse sucumb bulletin", a:"succumb"},
  {n:28, t:"adhesive exquisite unconscious misdemeaner", a:"misdemeanor"},
  {n:29, t:"medication intimate flamable phenomenon", a:"flammable"},
  {n:30, t:"synthetic ingeneous prejudice paradox", a:"ingenious"},
  {n:31, t:"infectious projector forbiddon historical", a:"forbidden"},
  {n:32, t:"delinquent superficial extrordinary supersede", a:"extraordinary"},
  {n:33, t:"oportunity classic juvenile document", a:"opportunity"},
  {n:34, t:"consequence imperative predominant prelimenary", a:"preliminary"},
  {n:35, t:"accident ambitious dependable communicate", a:"none"},
  {n:36, t:"intermedate periscope circumstance percentage", a:"intermediate"},
  {n:37, t:"appropriate soldier responsable insurance", a:"responsible"},
  {n:38, t:"percieve competent malfunction antecedent", a:"perceive"},
  {n:39, t:"college prisionor pension instructor", a:"prisoner"},
  {n:40, t:"intellegence survival exaggerate prediction", a:"intelligence"},
  {n:41, t:"controvercy tortoise extrovert insistent", a:"controversy"},
  {n:42, t:"thesaurus spherical cataract hygeine", a:"hygiene"},
  {n:43, t:"zucchini caucus connoisseur delicatesen", a:"delicatessen"},
  {n:44, t:"conjecture portfolio manuscript sargent", a:"sergeant"},
  {n:45, t:"souvenir physiology anatomy mocassin", a:"moccasin"},
  {n:46, t:"catastrophe arthritis leiutenent stethoscope", a:"lieutenant"},
  {n:47, t:"flexible graduate convertible supression", a:"suppression"},
  {n:48, t:"procession interupt vocational subscription", a:"interrupt"},
  {n:49, t:"labratory molecule sophisticated quiche", a:"laboratory"},
  {n:50, t:"physician antiseptic pyschology allergy", a:"psychology"}
];
let hasSubmitted = false;



function lockAllInputs(){
  // Lock student name + all answer inputs after submission
  const name = document.getElementById("studentName");
  if (name) name.disabled = true;
  document.querySelectorAll("#testForm input").forEach(el=>{ el.disabled = true; });
}

function unlockAllInputs(){
  // Unlock student name + all answer inputs (teacher reset)
  const name = document.getElementById("studentName");
  if (name) name.disabled = false;
  document.querySelectorAll("#testForm input").forEach(el=>{ el.disabled = false; });
}

function normWord(s){
  return (s ?? "")
    .toString()
    .trim()
    .replace(/\s+/g," ")
    .toLowerCase();
}

function csvEscape(value){
  const s = (value === null || value === undefined) ? "" : String(value);
  if (s.includes(",") || s.includes('"') || s.includes("\n")) return '"' + s.replace(/"/g,'""') + '"';
  return s;
}
function formatLocalTimestamp(){
  const d = new Date();
  const pad = (n)=> String(n).padStart(2,"0");
  return `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())} ${pad(d.getHours())}:${pad(d.getMinutes())}:${pad(d.getSeconds())}`;
}
function buildResultsCSV(payload){
  const header = ["Student Name","Timestamp","Total Score","Max Score","Percent","Answered"];
  const summary = [payload.studentName,payload.timestamp,payload.total,payload.maxScore,payload.pct,payload.answered];
  const lines = [];
  lines.push(header.map(csvEscape).join(","));
  lines.push(summary.map(csvEscape).join(","));
  lines.push("");
  lines.push(["Question","Group of Words","Student Answer","Correct Answer","Correct?"].map(csvEscape).join(","));
  for (const r of payload.rows){
    lines.push([r.q,r.prompt,r.student,r.correctAnswer,r.isCorrect?"YES":"NO"].map(csvEscape).join(","));
  }
  return lines.join("\n");
}
function downloadCSV(filename, csvText){
  const blob = new Blob([csvText], {type:"text/csv;charset=utf-8"});
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = filename;
  document.body.appendChild(a);
  a.click();
  a.remove();
  setTimeout(()=>URL.revokeObjectURL(url), 1000);
}

function el(tag, attrs={}, children=[]){
  const e = document.createElement(tag);
  for (const [k,v] of Object.entries(attrs)){
    if (k === "class") e.className = v;
    else if (k === "html") e.innerHTML = v;
    else e.setAttribute(k, v);
  }
  for (const c of children){
    if (typeof c === "string") e.appendChild(document.createTextNode(c));
    else e.appendChild(c);
  }
  return e;
}

function render(){
  const host = document.getElementById("qs");
  QUESTIONS.forEach(q=>{
    const box = el("div",{class:"q", id:`q${q.n}`},[
      el("div",{class:"qhead"},[
        el("div",{class:"qnum"},[String(q.n)]),
        el("div",{class:"qtext"},[
          el("div",{html:`<strong>${q.t}</strong>`}),
          el("div",{class:"hint"},["Type the corrected word, or type ", el("strong",{},["none"]), "."])
        ])
      ]),
      el("div",{class:"sa"},[
        el("label",{for:`ans${q.n}`},["Answer:"]),
        el("input",{type:"text", id:`ans${q.n}`, placeholder:""})
      ]),
      el("div",{class:"answer-key", id:`ak${q.n}`},[
        el("span",{class:"tag"},["Answer"]),
        el("span",{class:"val", id:`akv${q.n}`},["—"]),
        el("span",{class:"muted"},["(teacher)"])
      ])
    ]);
    host.appendChild(box);
  });
}

function clearHighlights(){ document.querySelectorAll(".q.correct,.q.incorrect").forEach(d=>d.classList.remove("correct","incorrect")); }
function markQuestion(n, status){
  const box = document.getElementById(`q${n}`);
  if (!box) return;
  box.classList.remove("correct","incorrect");
  if (status === "correct") box.classList.add("correct");
  if (status === "incorrect") box.classList.add("incorrect");
}
function getAnswer(n){ const i=document.getElementById(`ans${n}`); return i?i.value:""; }

let answersRevealed = false;
function showAnswerKeys(){
  QUESTIONS.forEach(q=>{
    const v=document.getElementById(`akv${q.n}`);
    const c=document.getElementById(`ak${q.n}`);
    if (v) v.textContent = q.a;
    if (c) c.style.display="block";
  });
}
function hideAnswerKeys(){ QUESTIONS.forEach(q=>{ const c=document.getElementById(`ak${q.n}`); if (c) c.style.display="none"; }); }
function toggleRevealAnswers(){
  const code = prompt("Teacher code required to reveal/hide the answer key:");
  if (code === null) return;
  if (code !== TEACHER_CODE){ alert("Incorrect teacher code. Answer key was not changed."); return; }
  answersRevealed = !answersRevealed;
  const btn=document.getElementById("revealBtn");
  if (answersRevealed){ showAnswerKeys(); if (btn) btn.textContent="Hide Answers (Teacher)"; }
  else { hideAnswerKeys(); if (btn) btn.textContent="Reveal Answers (Teacher)"; }
}

function score(){
  const nameInput = document.getElementById("studentName");
  const name = (nameInput ? nameInput.value.trim() : "");
  // Validate required name BEFORE locking submission
  if (!name){
    alert("Please enter your Student Name before submitting.");
    if (nameInput) nameInput.focus();
    return;
  }
  if (hasSubmitted) return;
  const ok = confirm("Submit now? You can only submit once.");
  if (!ok) return;
  hasSubmitted = true;
  const sb = document.getElementById("scoreBtn");
  sb.disabled = true;
  sb.textContent = "Submitted";
  lockAllInputs();
clearHighlights();

  let total=0;
  let answered=0;
  const rows=[];

  QUESTIONS.forEach(q=>{
    const raw = getAnswer(q.n);
    const student = normWord(raw);
    const correct = normWord(q.a);
    const isAnswered = student.length > 0;
    const isCorrect = isAnswered && (student === correct);

    if (isAnswered) answered += 1;
    if (isCorrect) total += 1;

    if (isAnswered) markQuestion(q.n, isCorrect ? "correct" : "incorrect");

    rows.push({q:q.n, prompt:q.t, student:raw, correctAnswer:q.a, isCorrect});
  });

  const maxScore = QUESTIONS.length;
  const pct = Math.round((total/maxScore)*1000)/10;

  document.getElementById("resultsBox").style.display="block";
  document.getElementById("rName").textContent = name;
  document.getElementById("rTotal").textContent = `${total} / ${maxScore}`;
  document.getElementById("rPct").textContent = `${pct}%`;
  document.getElementById("rAns").textContent = `${answered} / ${maxScore}`;
  document.getElementById("resultsTitle").textContent = "Results (Spelling Grade 8)";

  const timestamp = formatLocalTimestamp();
  const payload = {studentName:name,timestamp,total,maxScore,pct:pct+"%",answered,rows};
  const csvText = buildResultsCSV(payload);
  const safeName = name.replace(/[^a-z0-9]+/gi,"_").replace(/^_+|_+$/g,"");
  const filename = `KofC_Spelling_Grade8_${safeName || "Student"}_${timestamp.replace(/[: ]/g,"-")}.csv`;
  downloadCSV(filename, csvText);

  document.getElementById("resultsBox").scrollIntoView({behavior:"smooth", block:"start"});
}

function teacherReset(){
  const code = prompt("Teacher reset code required to clear all answers/results:");
  if (code === null) return;
  if (code !== TEACHER_CODE){ alert("Incorrect reset code. Answers were not cleared."); return; }
  if (!confirm("Clear all answers and results?")) return;

  document.getElementById("testForm").reset();
  // Student name is outside the form, so clear it explicitly
  const nameInput = document.getElementById("studentName");
  if (nameInput) nameInput.value = "";
  document.getElementById("resultsBox").style.display="none";
  clearHighlights();

  hasSubmitted = false;
  unlockAllInputs();
  const sb = document.getElementById("scoreBtn");
  sb.disabled = false;
  sb.textContent = "Submit & Score";

  if (answersRevealed) showAnswerKeys();
}

document.getElementById("scoreBtn").addEventListener("click", score);
document.getElementById("resetBtn").addEventListener("click", teacherReset);
document.getElementById("revealBtn").addEventListener("click", toggleRevealAnswers);

render();
</script>
</body>
</html>
